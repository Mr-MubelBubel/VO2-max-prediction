<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VO2max Toolkit</title>
    <link rel="stylesheet" href="../static/style.css">
    <script src="../static/index.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>
<body>
<div class="container">
    <div class="left-section">
        <div class="box">
            <form action="" method="POST">
                <div class="dropdown-wrapper" style="position: absolute; top: 10px; left: 10px;">
                    <div class="custom-select">
                        <label for="mode-select"></label>
                        <select id="mode-select" name="mode-select">
                            <option value="athletes">Athletes</option>
                            <option value="cyclists">Cyclists</option>
                        </select>
                    </div>
                </div>

                <div id="sliders-container">
                    <!-- Slider für VO2max -->
                    <div class="slider-wrapper">
                        <label for="slider1">VO2max:</label>
                        <input type="range" id="slider1" name="vo2max" min="40" max="80" step="0.1" value="55"
                               oninput="syncValue('vo2maxValue', this.value)">
                        <input type="text" id="vo2maxValue" value="55" oninput="syncSlider('slider1', this.value)">
                    </div>
                    <!-- Slider für vLamax -->
                    <div class="slider-wrapper">
                        <label for="slider2">vLamax:</label>
                        <input type="range" id="slider2" name="vLamax" min="0.2" max="1.5" step="0.01" value="0.5"
                               oninput="syncValue('vLamaxValue', this.value)">
                        <input type="text" id="vLamaxValue" value="0.5" oninput="syncSlider('slider2', this.value)">
                    </div>
                    <!-- Slider für Body Weight -->
                    <div class="slider-wrapper">
                        <label for="slider3">Body Weight:</label>
                        <input type="range" id="slider3" name="bodyWeight" min="40" max="100" step="0.1" value="70"
                               oninput="syncValue('bwValue', this.value)">
                        <input type="text" id="bwValue" value="70" oninput="syncSlider('slider3', this.value)">
                    </div>
                    <!-- Slider für Ks1 -->
                    <div class="slider-wrapper">
                        <label for="slider4">Ks1:</label>
                        <input type="range" id="slider4" name="ks1" min="0.2" max="0.3" step="0.01" value="0.25"
                               oninput="syncValue('ks1Value', this.value)">
                        <input type="text" id="ks1Value" value="0.25" oninput="syncSlider('slider4', this.value)">
                    </div>
                    <!-- Slider für Ks2 -->
                    <div class="slider-wrapper">
                        <label for="slider5">Ks2:</label>
                        <input type="range" id="slider5" name="ks2" min="1" max="1.2" step="0.01" value="1.1"
                               oninput="syncValue('ks2Value', this.value)">
                        <input type="text" id="ks2Value" value="1.1" oninput="syncSlider('slider5', this.value)">
                    </div>
                    <!-- Slider für VolRel -->
                    <div class="slider-wrapper">
                        <label for="slider6">VolRel:</label>
                        <input type="range" id="slider6" name="volRel" min="0.35" max="0.55" step="0.01" value="0.45"
                               oninput="syncValue('volRelValue', this.value)">
                        <input type="text" id="volRelValue" value="0.45" oninput="syncSlider('slider6', this.value)">
                    </div>
                </div>
            </form>
        </div>
        <div class="box">
            <div id="output-container">
                <h2>Results</h2>
                <p><strong>CarbMax:</strong> <span id="carb-max"> - </span><span class="unit-label">m/s</span></p>
                <p><strong>Velocity:</strong> <span id="vel"> 2.5 </span>mmol/L </p>
                <p><strong>Lactate:</strong> <span id="lactate"> - </span><span class="unit-label">m/s</span></p>
                <p><strong>Predicted Marathon finish:</strong> <span id="t-pred"> - </span>h</p>
                <p><strong>AT:</strong> <span id="at-speed"> - </span><span class="unit-label">m/s</span></p>
                <p><strong>Percentage of VO2max:</strong> <span id="at-percent"> - </span>%</p>
                <p><strong>FatMax:</strong> <span id="fat-max"> - </span><span class="unit-label">m/s</span></p>
                <br>
                <!-- Button to trigger PDF generation -->
                <button class="modern-btn" onclick="generatePDF()">Download PDF</button>
            </div>
        </div>
    </div>
    <div class="right-section">
        <div class="box">
            <div class="content">
                <img id="plot-pic" src="../static/plot.png" alt="Data Plot">
            </div>
        </div>
    </div>
</div>
<script>
    // Synchronisiert den Slider-Wert mit dem Eingabefeld
    function syncValue(textFeldID, value) {
        document.getElementById(textFeldID).value = value;
    }

    // Synchronisiert das Eingabefeld mit dem Slider
    function syncSlider(sliderId, value) {
        const slider = document.getElementById(sliderId);
        const numValue = parseFloat(value);

        // Überprüfen, ob der Wert innerhalb der Slider-Min/Max-Werte liegt
        if (!isNaN(numValue) && numValue >= parseFloat(slider.min) && numValue <= parseFloat(slider.max)) {
            slider.value = numValue;
        } else {
            console.log("Value out of range or invalid.");
        }
    }

    document.getElementById("mode-select").addEventListener("change", function() {
      let mode = this.value;

      if (mode === "cyclists") {
        document.querySelectorAll('.unit-label').forEach(function(label) {
          label.textContent = " W/s";
        });
      } else {
        document.querySelectorAll('.unit-label').forEach(function(label) {
          label.textContent = "m/s";
        });
      }
    });
</script>
</body>
</html>